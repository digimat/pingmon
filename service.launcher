#!/bin/sh

SERVICEPATH=/home/pi/python/pingmon
DEFAULTSERVICE=pingmon.py
SERVICE=${1:-$DEFAULTSERVICE}

logger "Upgrading service [$SERVICE] via git if needed..."

if [ -d $SERVICEPATH ]; then
	cd $SERVICEPATH
	git fetch origin > /dev/null
	git reset --hard origin/master > /dev/null
	 
	if [ -f $SERVICEPATH/$SERVICE ]; then
		logger "Launching service [$SERVICE]"
		exec /usr/bin/python $SERVICEPATH/$SERVICE
	fi
fi

logger "$0:unable to find service [$SERVICE]"
/bin/sleep 15
